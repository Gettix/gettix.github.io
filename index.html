<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RewardRush</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
	body{
         color: white;
	 background-image: linear-gradient(to bottom,#FFC300,#CACFD2);
         display: flex;
         flex-direction: column;
         align-items: center;
         font-size: 18px;
      }

      .hint{
         color: var(--tg-theme-hint-color);
      }

      .link{
         color: var(--tg-theme-link-color);
      }

      .button:not(:last-child){
         margin-bottom: 20px
      }

      .balance_text {
	text-align: center;
	color: #678AE3;

      }
	    
      #usercard{
         text-align: center;
      }
	  
      .centered {
         top: 50%;
         left: 50%;
	 color: white;
         text-align: center;
      }
	
      .button {
        padding: 15px 25px;
        font-size: 24px;
        text-align: center;
        cursor: pointer;
        outline: none;
        background: green;
        color: white;
        background-color: rgba(199, 0, 57, .10);
        border: none;
        border-radius: 15px;
      }

	.button_frame {
        padding: 30px 55px;
        font-size: 24px;
	text-align: center;
        outline: none;
        background: green;
        color: var(--tg-theme-button-text-color);
        background-color: rgba(255, 87, 51,.10);
        border: none;
        border-radius: 15px;
      }

      .btn:disabled, .btn:hover:disabled {
  	background-color: rgba(0,0,0,.1);
  	border: 1px solid rgba(0, 0, 0, .1);
  	cursor: not-allowed;
	}
      .button:hover {background-color: gray}
    </style>
  </head>
  <body>
    <div id="usercard"> <!--Карта профиля, человека, который к нам обратился-->
    </div>
    <div class="button_frame">
	    <p class="balance_text">Your balance</p>
	    <h1 class="centered" id="coinTab">0</h1>
	    <button onclick="startTimer()" class="button" id="timerDisplay">Work</button>
    </div>

    <script>
      var timeLeft = 100; 
	  var temp = 0;
	  var coins = 0;
      
      function startTimer() {
          if (timeLeft > 0 && temp == 0) {
	      document.getElementById("timerDisplay").disabled = true;
	      document.querySelector('.button').style.backgroundColor = "rgba(199, 0, 57, .3)";
              document.getElementById("timerDisplay").textContent = "Working... (" + timeLeft + ")";
              timeLeft--;
              setTimeout(startTimer, 100);
          } else if (temp == 1) {
		  	  
			  document.getElementById("timerDisplay").textContent = "Work";
			  timeLeft = 100;
			  coins += 100;
			  document.getElementById("coinTab").textContent = coins;
			  temp = 0;
		  	  clicked == 0;
          } else {
		  	document.getElementById("timerDisplay").disabled = false;
			document.getElementById("timerDisplay").textContent = "Earn 100!";
            clearInterval();
            resetButtonColor();
			temp = 1;
		  }
      }
      
      function resetButtonColor() {
          var button = document.querySelector('.button');
          if (button) {
              if (button.style.backgroundColor === "rgba(199, 0, 57, .3)") {
                  button.style.backgroundColor = "rgba(199, 0, 57, .10)";
                  timeLeft = 10; // Reset the timer
              }
          }
      }
    </script>
  </body>
  <script>
	let tg = window.Telegram.WebApp;
	tg.expand();

	let earnButt = document.getElementById("timerDisplay");
	earnButt.addEventListener('click', function(){
		if (document.getElementById("timerDisplay").textContent == "Earn 100!") {
			tg.sendData("Hi");
		};
      	//при клике на основную кнопку отправляем данные в строковом виде
   	});
	
	  
	let usercard = document.getElementById("usercard"); //получаем блок usercard 
      	let profName = document.createElement('h1'); //создаем заголовок
     	profName.innerText = `@${tg.initDataUnsafe.user.username}`;
    	usercard.appendChild(profName);
	  
  </script>
</html>
